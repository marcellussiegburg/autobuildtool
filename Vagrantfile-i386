# -*- mode: ruby -*-
# vi: set ft=ruby :
###  (c) Marcellus Siegburg, 2013, License: GPL

Vagrant.configure("2") do |config|
  config.vm.box = "ubuntu-1310-i386"
  config.vm.box_url = "http://puppet-vagrant-boxes.puppetlabs.com/ubuntu-1310-i386-virtualbox-puppet.box"

  config.vm.provider "virtualbox" do |v|
    v.name = "Autotool Autoconfigured " + Time.now.to_s
    v.customize ["modifyvm", :id,
                 "--memory", "768"]
  end

  config.vm.network "forwarded_port", guest: 80, host: 8080, auto_correct: true

  config.vm.provision "puppet" do |puppet|
    puppet.module_path = "modules"
    puppet.manifests_path = "manifests"
    puppet.manifest_file = "site.pp"
    puppet.hiera_config_path = "hiera.yaml"
    puppet.options = ["--user", "vagrant",
                      "--no-daemonize",
                      "--detailed-exitcodes",
                      "--verbose",
                      "--logdest", "console",
                      "--logdest", "/vagrant/build.log"]
  end
end
